<!DOCTYPE html>
<html>
    <head>
        <title>MY First TODO list</title>

    </head>
    <body>
        <script>
            
            todos = JSON.parse(localStorage.getItem('ob'));
            if (todos == null){
                todos = new Array();
            }

            
            
            function showTodo(){
                console.log(todos);
                document.getElementById('todolist').innerHTML = "";
                for (let t in todos){
                    e = document.createElement('li');
                    e.innerText = todos[t]["todo"];

                    upBtn = document.createElement('button');
                    upBtn.setAttribute('onclick', 'upTodo(this)');
                    upBtn.innerText = 'UP';
                    e.appendChild(upBtn);

                    downBtn = document.createElement('button');
                    downBtn.setAttribute('onclick', 'downTodo(this)');
                    downBtn.innerText = 'DOWN';
                    e.appendChild(downBtn);

                    delBtn = document.createElement('button');
                    delBtn.setAttribute('onclick', 'delTodo(this)');
                    delBtn.innerText = 'del';
                    e.appendChild(delBtn);



                    document.getElementById('todolist').appendChild(e);
                }
                localStorage.setItem('ob', JSON.stringify(todos));
            }
            
            function addTodo(){
                todo = document.getElementById("todo").value;
                t = {"todo":todo, "color":""}
                todos.push(t);
                showTodo()

            }

            function delTodo(tmp){
                p = tmp.parentNode;
                todo = p.innerText;
                todo = todo.substring(0, todo.length-9);
                color = "";
                let i = todos.findIndex(i => i.todo == todo);
                todos.splice(i,1);
                p.remove()
                localStorage.setItem('ob', JSON.stringify(todos));            
            }

            function upTodo(tmp){
                p = tmp.parentNode;
                todo = p.innerText;
                todo = todo.substring(0, todo.length-9);
                color = "";
                let i = todos.findIndex(i => i.todo == todo);
                console.log(i);
                todos.splice(i,1);
                todos.splice(i-1, 0 , {"todo":todo, "color":""});

                showTodo()
                

            }

            function downTodo(tmp){
                p = tmp.parentNode;
                todo = p.innerText;
                todo = todo.substring(0, todo.length-9);
                color = "";
                let i = todos.findIndex(i => i.todo == todo);
                console.log(i);
                todos.splice(i,1);
                todos.splice(i+1, 0 , {"todo":todo, "color":""});

                showTodo()

            }
        </script>
        <input type="text" id="todo" name="todo" value="123">
        <button onclick="addTodo()">Add</button>
        <ul id='todolist'> 

        </ul>

        <script>
            showTodo()
        </script>
    </body>
</html>